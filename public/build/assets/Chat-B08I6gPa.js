import{r as a,a as p,j as e,H as w}from"./app-BlZNpJaz.js";import{g as v}from"./utils-CTsRgsKi.js";import{MessageCard as N}from"./MessageCard-DIFcxOBi.js";import{A as R}from"./arrow-left-C_Tsc45O.js";import{L as z}from"./loader-circle-DIuL06p2.js";import{R as E}from"./refresh-ccw-FwuYeQl2.js";import{S as C}from"./send-CD005u8Q.js";/* empty css            */import"./button-BFaAQ1F0.js";import"./index-BSNktiLJ.js";import"./createLucideIcon-G_Aima0p.js";import"./check-C5YBzlMP.js";import"./file-text-BPl73Zr-.js";function D({channel:s,messages:i}){const[o,l]=a.useState(i.data.slice().reverse()),n=a.useRef(null),[h,b]=a.useState(!0);a.useEffect(()=>{l(i.data.slice().reverse())},[i]);const c=(r=!0)=>{n.current?.scrollIntoView({behavior:r?"smooth":"auto"})};a.useEffect(()=>{h?(c(!1),b(!1)):c()},[o]);const[m,x]=a.useState(!1),g=async()=>{try{const t=(await p.get(`/agenda/channels/${s.id}/poll?t=${Date.now()}`)).data.data.slice().reverse();l(d=>{if(!t||t.length===0)return d;const f=j=>j.map(u=>`${u.id}-${u.read_at||"null"}`).join("|");return f(d)!==f(t)?t:d})}catch(r){console.error("Poll failed",r)}},y=async()=>{x(!0),await g(),setTimeout(()=>x(!1),500)};a.useEffect(()=>{const r=setInterval(g,4e3);return()=>clearInterval(r)},[s.id]),a.useEffect(()=>{o.forEach(r=>{!r.is_me&&!r.read_at&&k(r.id)})},[o]);const k=async r=>{try{await p.post(`/agenda/messages/${r}/read`)}catch(t){console.error("Failed to mark read",t)}};return e.jsxs("div",{className:"flex flex-col h-screen bg-gray-50 dark:bg-gray-900 transition-colors duration-300 relative",children:[e.jsx(w,{title:s.name}),e.jsx("div",{className:"fixed inset-0 z-0 bg-gray-50 dark:bg-gray-900"}),e.jsxs("div",{className:"mx-4 mt-4 rounded-3xl bg-white/70 dark:bg-gray-800/70 backdrop-blur-xl backdrop-saturate-150 border border-white/20 dark:border-white/10 shadow-sm inset ring-1 ring-white/30 dark:ring-white/5 pt-3 pb-3 px-4 flex items-center gap-2 sticky top-4 z-20",children:[e.jsx("button",{onClick:()=>window.history.back(),className:"p-2 -ml-2 hover:bg-black/5 dark:hover:bg-white/10 rounded-full transition-all group",children:e.jsx(R,{size:24,className:"text-gray-700 dark:text-gray-200"})}),e.jsxs("div",{className:"flex items-center gap-3 flex-1 overflow-hidden",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center shrink-0 border border-white/50 dark:border-gray-600 overflow-hidden",children:s.icon&&(s.icon.startsWith("http")||s.icon.startsWith("/"))?e.jsx("img",{src:s.icon,alt:"",className:"h-full w-full object-cover"}):e.jsx("span",{className:"font-semibold text-sm text-gray-600 dark:text-gray-300",children:v(s.name)})}),e.jsxs("div",{className:"flex flex-col justify-center",children:[e.jsx("h1",{className:"text-base font-bold text-gray-900 dark:text-gray-100 truncate leading-none mb-0.5",children:s.name}),e.jsx("div",{className:"flex items-center gap-1.5",children:e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:"Toque para ver dados"})})]})]}),e.jsx("button",{onClick:y,disabled:m,className:"p-2 rounded-full hover:bg-black/5 dark:hover:bg-white/10 text-gray-500 dark:text-gray-400 transition-all active:scale-95",children:m?e.jsx(z,{size:20,className:"animate-spin"}):e.jsx(E,{size:20})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-2 sm:px-4 py-6 space-y-6 z-10",children:[o.map(r=>e.jsx(N,{message:r},r.id)),e.jsx("div",{ref:n})]}),e.jsx("div",{className:"p-4 bg-transparent safe-area-bottom z-10",children:e.jsxs("div",{className:"bg-white/70 dark:bg-gray-800/70 backdrop-blur-xl rounded-[2rem] shadow-sm p-2 px-3 flex items-center gap-2 border border-white/20 dark:border-white/5",children:[e.jsx("input",{type:"text",placeholder:"Não é possível responder...",disabled:!0,className:"flex-1 bg-transparent border-none py-3 px-4 text-sm focus:ring-0 text-gray-500 dark:text-gray-400 placeholder:text-gray-400 dark:placeholder:text-gray-600 italic h-12"}),e.jsx("button",{disabled:!0,className:"h-10 w-10 flex items-center justify-center bg-gray-100 dark:bg-gray-700 text-gray-400 dark:text-gray-500 rounded-full shrink-0",children:e.jsx(C,{size:18})})]})})]})}export{D as default};
