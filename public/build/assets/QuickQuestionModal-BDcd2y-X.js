import{r as g,j as e,a as j}from"./app-BlZNpJaz.js";import{f as C,e as _,b as D,c as E,d as M}from"./dialog-CCWmf-Wy.js";import{P as L}from"./plus-CcX2yXqX.js";import{T as O}from"./trash-2-C65_v2RJ.js";import{L as A}from"./loader-circle-DIuL06p2.js";function R({bankId:l,isOpen:x,onClose:c,onQuestionCreated:k,questionToEdit:o=null}){const[u,m]=g.useState(!1),[b,p]=g.useState(""),n={id:null,question_bank_id:l,statement:"",type:"MULTIPLE_CHOICE",difficulty:1,explanation:"",subject:"",topic:"",grade_level:"",bncc_code:"",options:[{label:"",is_correct:!1},{label:"",is_correct:!1}]},[r,i]=g.useState(n);o&&r.id!==o.id&&i({...n,...o,options:(o.options||[]).map(a=>({id:a.id,label:a.label,is_correct:!!a.is_correct}))}),x&&!o&&r.id&&i(n);const d=(a,t)=>{i(s=>({...s,[a]:t}))},v=()=>{i(a=>({...a,options:[...a.options,{label:"",is_correct:!1}]}))},w=a=>{r.options.length<=2||i(t=>{const s=[...t.options];return s.splice(a,1),{...t,options:s}})},h=(a,t,s)=>{i(y=>{const f=[...y.options];return f[a][t]=s,{...y,options:f}})},N=async a=>{a.preventDefault(),m(!0),p("");try{let t;r.id?t=await j.put(`/professor/questions/${r.id}`,{...r,question_bank_id:l}):t=await j.post("/professor/questions",{...r,question_bank_id:l}),t.data.success&&(k(t.data.question),c(),o||i({...n,question_bank_id:l}))}catch(t){console.error(t),p(t.response?.data?.message||"Erro ao salvar questão.")}finally{m(!1)}};return e.jsx(C,{open:x,onOpenChange:a=>!a&&c(),children:e.jsxs(_,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(D,{children:[e.jsx(E,{children:o?"Editar Questão":"Nova Questão Rápida"}),e.jsx(M,{children:o?"Atualize os dados da questão abaixo.":"Preencha os dados abaixo para criar uma nova questão e adicioná-la imediatamente ao banco selecionado."})]}),e.jsxs("form",{onSubmit:N,className:"space-y-6 py-4",children:[b&&e.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded-md text-sm",children:b}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300",children:"Tipo de Questão"}),e.jsxs("select",{value:r.type,onChange:a=>d("type",a.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-gray-900 bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-white",children:[e.jsx("option",{value:"MULTIPLE_CHOICE",children:"Múltipla Escolha"}),e.jsx("option",{value:"TRUE_FALSE",children:"Verdadeiro ou Falso"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300",children:"Dificuldade"}),e.jsxs("select",{value:r.difficulty,onChange:a=>d("difficulty",parseInt(a.target.value)),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-gray-900 bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-white",children:[e.jsx("option",{value:1,children:"Fácil"}),e.jsx("option",{value:2,children:"Médio"}),e.jsx("option",{value:3,children:"Difícil"}),e.jsx("option",{value:4,children:"Muito Difícil"}),e.jsx("option",{value:5,children:"Expert"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1 dark:text-gray-300",children:"Enunciado"}),e.jsx("textarea",{value:r.statement,onChange:a=>d("statement",a.target.value),rows:3,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2 text-gray-900 bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-white",placeholder:"Digite a pergunta...",required:!0})]}),e.jsx("div",{className:"border rounded-md p-3 bg-gray-50 dark:bg-gray-800 dark:border-gray-700",children:e.jsxs("details",{className:"group",open:!!(r.subject||r.topic||r.grade_level||r.bncc_code),children:[e.jsxs("summary",{className:"flex justify-between items-center font-medium cursor-pointer list-none text-sm text-gray-700 dark:text-gray-300",children:[e.jsx("span",{children:"Mais Detalhes (Opcional)"}),e.jsx("span",{className:"transition group-open:rotate-180",children:e.jsx("svg",{fill:"none",height:"24",shapeRendering:"geometricPrecision",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",viewBox:"0 0 24 24",width:"24",children:e.jsx("path",{d:"M6 9l6 6 6-6"})})})]}),e.jsxs("div",{className:"text-gray-600 mt-3 group-open:animate-fadeIn grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1 dark:text-gray-400",children:"Matéria / Disciplina"}),e.jsx("input",{type:"text",value:r.subject||"",onChange:a=>d("subject",a.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm p-2 text-gray-900 bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-white",placeholder:"Ex: Matemática"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1 dark:text-gray-400",children:"Assunto / Tópico"}),e.jsx("input",{type:"text",value:r.topic||"",onChange:a=>d("topic",a.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm p-2 text-gray-900 bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-white",placeholder:"Ex: Álgebra"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1 dark:text-gray-400",children:"Nível de Ensino"}),e.jsx("input",{type:"text",value:r.grade_level||"",onChange:a=>d("grade_level",a.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm p-2 text-gray-900 bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-white",placeholder:"Ex: 8º Ano"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1 dark:text-gray-400",children:"Código BNCC"}),e.jsx("input",{type:"text",value:r.bncc_code||"",onChange:a=>d("bncc_code",a.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm p-2 text-gray-900 bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-white",placeholder:"Ex: EF08MA01"})]})]})]})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Alternativas"}),e.jsxs("button",{type:"button",onClick:v,className:"text-xs text-indigo-600 flex items-center gap-1 font-medium",children:[e.jsx(L,{className:"w-3 h-3"})," Adicionar"]})]}),e.jsx("div",{className:"space-y-2",children:r.options.map((a,t)=>e.jsxs("div",{className:"flex gap-2 items-start",children:[e.jsx("div",{className:"pt-2",children:e.jsx("input",{type:"checkbox",checked:a.is_correct,onChange:s=>h(t,"is_correct",s.target.checked),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded",title:"Correta"})}),e.jsx("div",{className:"flex-grow",children:e.jsx("input",{type:"text",value:a.label,onChange:s=>h(t,"label",s.target.value),className:`block w-full rounded-md shadow-sm text-sm p-2 border ${a.is_correct?"border-green-300 bg-green-50 text-green-900 dark:bg-green-900/30 dark:border-green-600 dark:text-green-300 placeholder-green-300":"border-gray-300 bg-white text-gray-900 dark:bg-gray-800 dark:border-gray-700 dark:text-white placeholder-gray-400"}`,placeholder:`Opção ${t+1}`,required:!0})}),e.jsx("button",{type:"button",onClick:()=>w(t),className:"pt-2 text-gray-400 hover:text-red-600 disabled:opacity-30 transition-colors",disabled:r.options.length<=2,children:e.jsx(O,{className:"w-4 h-4"})})]},t))})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-100 dark:border-gray-700",children:[e.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors text-sm dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600",children:"Cancelar"}),e.jsxs("button",{type:"submit",disabled:u,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors disabled:opacity-50 text-sm flex items-center gap-2",children:[u&&e.jsx(A,{className:"w-4 h-4 animate-spin"}),o?"Atualizar Questão":"Salvar Questão"]})]})]})]})})}export{R as Q};
