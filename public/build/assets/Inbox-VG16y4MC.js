import{c as ce,r as R,h as de,e as me,j as t,a as ge,H as he,L as ee}from"./app-BlZNpJaz.js";import{ComposeModal as fe}from"./ComposeModal-BpEauYpC.js";import{g as xe}from"./utils-CTsRgsKi.js";import{B as K}from"./button-BFaAQ1F0.js";import{I as ue}from"./input-ClKI_C3W.js";import{P as pe}from"./plus-CcX2yXqX.js";import{S as oe}from"./search-BKAEKSF4.js";import{A as be}from"./arrow-left-C_Tsc45O.js";import{L as ye}from"./loader-circle-DIuL06p2.js";import{R as ke}from"./refresh-ccw-FwuYeQl2.js";import{S as je,M as we}from"./sun-CZaAGN2o.js";import{S as ve}from"./settings-DDioBNBR.js";/* empty css            */import"./dialog-CCWmf-Wy.js";import"./index-DWBLVih3.js";import"./createLucideIcon-G_Aima0p.js";import"./index-II6TlMg7.js";import"./index-BSNktiLJ.js";import"./Combination-CQbiwxas.js";import"./index-ePvy9ijt.js";import"./label-D4nWcODD.js";import"./select-wa9XAM0x.js";import"./index-20W_Bwtk.js";import"./index-CClcdcON.js";import"./index-DSX7JKB1.js";import"./index-DPYlP-Xg.js";import"./chevron-down-BzXkxksi.js";import"./check-C5YBzlMP.js";import"./textarea-BfFOsk1d.js";import"./send-CD005u8Q.js";function tt(a){const e=ce.c(79),{channels:A,allowedChannels:M,canConfigure:te}=a;let O;e[0]!==M?(O=M===void 0?[]:M,e[0]=M,e[1]=O):O=e[1];const s=O,g=te===void 0?!1:te,[Q,ae]=R.useState(!1),[l,ie]=R.useState(""),{appearance:o,updateAppearance:V}=de(),{settings:T}=me().props;let B;e[2]!==o||e[3]!==V?(B=()=>{V(o==="dark"?"light":"dark")},e[2]=o,e[3]=V,e[4]=B):B=e[4];const E=B,h=T?.logo_light_url||T?.logo_url,f=T?.logo_dark_url||T?.logo_url,[X,re]=R.useState(A),[i,se]=R.useState(!1);let P,$;e[5]!==A?(P=()=>{re(A)},$=[A],e[5]=A,e[6]=P,e[7]=$):(P=e[6],$=e[7]),R.useEffect(P,$);let D;e[8]===Symbol.for("react.memo_cache_sentinel")?(D=async()=>{try{const k=(await ge.get(`/agenda/inbox?t=${Date.now()}`,{headers:{Accept:"application/json"}})).data.channels;re(m=>JSON.stringify(m)!==JSON.stringify(k)?k:m)}catch(r){console.error("Inbox poll failed",r)}},e[8]=D):D=e[8];const le=D;let H;e[9]===Symbol.for("react.memo_cache_sentinel")?(H=async()=>{se(!0),await le(),setTimeout(()=>se(!1),500)},e[9]=H):H=e[9];const ne=H;let J,W;e[10]===Symbol.for("react.memo_cache_sentinel")?(W=()=>{const r=setInterval(le,5e3);return()=>clearInterval(r)},J=[],e[10]=J,e[11]=W):(J=e[10],W=e[11]),R.useEffect(W,J);let x,u,p,n,c,d;if(e[12]!==s.length||e[13]!==o||e[14]!==g||e[15]!==i||e[16]!==X||e[17]!==f||e[18]!==h||e[19]!==l||e[20]!==E){let r;e[27]!==l?(r=Z=>Z.name.toLowerCase().includes(l.toLowerCase()),e[27]=l,e[28]=r):r=e[28];const k=X.filter(r);p="flex h-full flex-col bg-background",e[29]===Symbol.for("react.memo_cache_sentinel")?(n=t.jsx(he,{title:"Agenda"}),c=t.jsx("div",{className:"fixed inset-0 z-0 bg-gray-50 dark:bg-gray-900 transition-colors duration-300"}),e[29]=n,e[30]=c):(n=e[29],c=e[30]);let m;e[31]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx(ee,{href:"/dashboard",className:"p-2 -ml-2 hover:bg-black/5 dark:hover:bg-white/10 rounded-full text-foreground transition-all group",children:t.jsx(be,{className:"h-6 w-6 text-gray-700 dark:text-gray-200"})}),e[31]=m):m=e[31];let j;e[32]!==f||e[33]!==h?(j=t.jsxs("div",{className:"flex items-center gap-3",children:[m,h||f?t.jsxs(t.Fragment,{children:[t.jsx("img",{src:h,alt:"Logo",className:"h-8 w-auto object-contain dark:hidden"}),t.jsx("img",{src:f,alt:"Logo",className:"h-8 w-auto object-contain hidden dark:block"})]}):t.jsx("h1",{className:"text-2xl font-bold tracking-tight text-gray-800 dark:text-gray-100",children:"Mensagens"})]}),e[32]=f,e[33]=h,e[34]=j):j=e[34];let w;e[35]!==i?(w=i?t.jsx(ye,{className:"h-5 w-5 animate-spin"}):t.jsx(ke,{className:"h-5 w-5"}),e[35]=i,e[36]=w):w=e[36];let v;e[37]!==i||e[38]!==w?(v=t.jsx(K,{size:"icon",variant:"ghost",className:"rounded-full h-10 w-10 text-gray-600 dark:text-gray-300 hover:bg-black/5 dark:hover:bg-white/10 transition-all",onClick:ne,disabled:i,children:w}),e[37]=i,e[38]=w,e[39]=v):v=e[39];let N;e[40]!==o?(N=o==="dark"?t.jsx(je,{className:"h-5 w-5"}):t.jsx(we,{className:"h-5 w-5"}),e[40]=o,e[41]=N):N=e[41];let S;e[42]!==N||e[43]!==E?(S=t.jsx(K,{size:"icon",variant:"ghost",className:"rounded-full h-10 w-10 text-gray-600 dark:text-gray-300 hover:bg-black/5 dark:hover:bg-white/10 transition-all",onClick:E,children:N}),e[42]=N,e[43]=E,e[44]=S):S=e[44];let C;e[45]!==g?(C=g&&t.jsx(ee,{href:"/admin/agenda/settings",children:t.jsx(K,{size:"icon",variant:"ghost",className:"rounded-full h-10 w-10 text-gray-600 dark:text-gray-300 hover:bg-black/5 dark:hover:bg-white/10 transition-all",children:t.jsx(ve,{className:"h-6 w-6"})})}),e[45]=g,e[46]=C):C=e[46];let _;e[47]!==s.length?(_=s.length>0&&t.jsx(K,{size:"icon",variant:"ghost",className:"rounded-full h-10 w-10 text-gray-600 dark:text-gray-300 hover:bg-black/5 dark:hover:bg-white/10 transition-all",onClick:()=>ae(!0),children:t.jsx(pe,{className:"h-7 w-7"})}),e[47]=s.length,e[48]=_):_=e[48];let L;e[49]!==v||e[50]!==S||e[51]!==C||e[52]!==_?(L=t.jsxs("div",{className:"flex gap-2",children:[v,S,C,_]}),e[49]=v,e[50]=S,e[51]=C,e[52]=_,e[53]=L):L=e[53];let I;e[54]!==j||e[55]!==L?(I=t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[j,L]}),e[54]=j,e[55]=L,e[56]=I):I=e[56];let q;e[57]===Symbol.for("react.memo_cache_sentinel")?(q=t.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400",children:t.jsx(oe,{className:"h-4 w-4"})}),e[57]=q):q=e[57];let G;e[58]===Symbol.for("react.memo_cache_sentinel")?(G=Z=>ie(Z.target.value),e[58]=G):G=e[58];let z;e[59]!==l?(z=t.jsxs("div",{className:"relative",children:[q,t.jsx(ue,{placeholder:"Buscar",className:"pl-9 bg-gray-100/50 dark:bg-gray-900/50 border-transparent placeholder:text-gray-500 dark:placeholder:text-gray-400 text-gray-900 dark:text-gray-100 focus-visible:ring-0 h-10 rounded-xl transition-all hover:bg-gray-100 dark:hover:bg-gray-900",value:l,onChange:G})]}),e[59]=l,e[60]=z):z=e[60],e[61]!==I||e[62]!==z?(d=t.jsxs("div",{className:"sticky top-0 z-20 mx-4 mt-4 rounded-3xl bg-white/70 dark:bg-gray-800/70 backdrop-blur-xl backdrop-saturate-150 border border-white/20 dark:border-white/10 shadow-sm inset ring-1 ring-white/30 dark:ring-white/5 px-4 py-4 transition-all duration-200",children:[I,z]}),e[61]=I,e[62]=z,e[63]=d):d=e[63],x="flex-1 overflow-y-auto px-4 pb-4 z-10 mt-4",u=k.length===0?t.jsxs("div",{className:"flex h-full flex-col items-center justify-center space-y-3 text-muted-foreground mt-10",children:[t.jsx("div",{className:"rounded-full bg-gray-100 dark:bg-gray-800 p-4",children:t.jsx(oe,{className:"h-8 w-8 opacity-50 text-gray-500 dark:text-gray-400"})}),t.jsx("p",{className:"font-medium text-gray-600 dark:text-gray-400",children:"Nenhum canal encontrado."})]}):t.jsx("div",{className:"space-y-3 pt-2",children:k.map(Ne)}),e[12]=s.length,e[13]=o,e[14]=g,e[15]=i,e[16]=X,e[17]=f,e[18]=h,e[19]=l,e[20]=E,e[21]=x,e[22]=u,e[23]=p,e[24]=n,e[25]=c,e[26]=d}else x=e[21],u=e[22],p=e[23],n=e[24],c=e[25],d=e[26];let b;e[64]!==x||e[65]!==u?(b=t.jsx("div",{className:x,children:u}),e[64]=x,e[65]=u,e[66]=b):b=e[66];let F;e[67]===Symbol.for("react.memo_cache_sentinel")?(F=()=>ae(!1),e[67]=F):F=e[67];const Y=g?"/admin/agenda/message":"/professor/agenda/message";let y;e[68]!==s||e[69]!==Q||e[70]!==Y?(y=t.jsx(fe,{isOpen:Q,onClose:F,channels:s,submitUrl:Y}),e[68]=s,e[69]=Q,e[70]=Y,e[71]=y):y=e[71];let U;return e[72]!==p||e[73]!==n||e[74]!==c||e[75]!==d||e[76]!==b||e[77]!==y?(U=t.jsxs("div",{className:p,children:[n,c,d,b,y]}),e[72]=p,e[73]=n,e[74]=c,e[75]=d,e[76]=b,e[77]=y,e[78]=U):U=e[78],U}function Ne(a){return t.jsxs(ee,{href:`/agenda/channels/${a.id}`,className:"group flex items-center gap-4 p-3 rounded-2xl transition-all duration-200 bg-white/60 dark:bg-gray-800/60 hover:bg-white dark:hover:bg-gray-800 border border-white/40 dark:border-white/5 shadow-sm hover:shadow-md backdrop-blur-md hover:scale-[1.01] active:scale-[0.99]",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"flex h-12 w-12 shrink-0 items-center justify-center rounded-full bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-300 font-bold border border-white/50 dark:border-gray-600 overflow-hidden",children:a.icon&&(a.icon.startsWith("http")||a.icon.startsWith("/"))?t.jsx("img",{src:a.icon,alt:"",className:"h-full w-full object-cover"}):t.jsx("span",{className:"text-lg",children:xe(a.name)})}),t.jsx("span",{className:"absolute bottom-0 right-0 h-3 w-3 rounded-full bg-green-500 border-2 border-white dark:border-gray-800"})]}),t.jsxs("div",{className:"flex-1 min-w-0 border-b border-gray-100 dark:border-gray-700/50 pb-2 group-last:border-0",children:[t.jsxs("div",{className:"flex justify-between items-baseline mb-0.5",children:[t.jsx("h2",{className:"font-bold text-base truncate text-gray-900 dark:text-gray-100 group-hover:text-black dark:group-hover:text-white",children:a.name}),a.last_message_at&&t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium shrink-0 ml-2",children:a.last_message_at})]}),t.jsxs("div",{className:"flex justify-between items-center gap-2",children:[t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 truncate flex-1 font-medium group-hover:text-gray-800 dark:group-hover:text-gray-200",children:a.last_message||"Nenhuma mensagem"}),a.unread_count>0&&t.jsx("span",{className:"flex h-5 min-w-5 items-center justify-center rounded-full bg-blue-600 dark:bg-blue-500 text-[10px] font-bold text-white shadow-sm",children:a.unread_count})]})]})]},a.id)}export{tt as default};
