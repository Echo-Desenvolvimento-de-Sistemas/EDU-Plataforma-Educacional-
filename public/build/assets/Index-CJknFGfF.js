import{c as Me,u as ze,j as t,b as Te,H as Ve}from"./app-BlZNpJaz.js";import{C as qe,A as Ee}from"./app-layout-vfDevXcM.js";import{C as ge,a as Ne,b as Se,d as we,c as Ce}from"./card-DE5xUgg4.js";import{c as re,S as ie,a as ce,b as ne,d as oe}from"./select-wa9XAM0x.js";import{B as De}from"./button-BFaAQ1F0.js";import{L as M}from"./label-D4nWcODD.js";import{I as Le}from"./input-ClKI_C3W.js";import{c as ye}from"./utils-CTsRgsKi.js";import{S as Re}from"./search-BKAEKSF4.js";/* empty css            */import"./index-BSNktiLJ.js";import"./index-DWBLVih3.js";import"./createLucideIcon-G_Aima0p.js";import"./index-II6TlMg7.js";import"./Combination-CQbiwxas.js";import"./index-ePvy9ijt.js";import"./index-CClcdcON.js";import"./index-DSX7JKB1.js";import"./index-20W_Bwtk.js";import"./index-kh-3lYpY.js";import"./index-jOkOEACf.js";import"./settings-DDioBNBR.js";import"./users-CYmdu12r.js";import"./file-text-BPl73Zr-.js";import"./chevron-right-BaSAJNUd.js";import"./index-DPYlP-Xg.js";import"./chevron-down-BzXkxksi.js";import"./check-C5YBzlMP.js";const Be=[{title:"Dashboard",href:"/admin/dashboard"},{title:"Frequência",href:"/admin/attendance"}];function Nt(a){const e=Me.c(94),{classRooms:de,subjects:me,filters:c,data:i}=a,xe=c?.class_room_id||"",he=c?.subject_id||"";let n;e[0]!==c?.month?(n=c?.month||new Date().getMonth()+1+"",e[0]=c?.month,e[1]=n):n=e[1];let o;e[2]!==c?.year?(o=c?.year||new Date().getFullYear()+"",e[2]=c?.year,e[3]=o):o=e[3];let z;e[4]===Symbol.for("react.memo_cache_sentinel")?(z=new Date().toISOString().split("T"),e[4]=z):z=e[4];let T;e[5]!==xe||e[6]!==he||e[7]!==n||e[8]!==o?(T={class_room_id:xe,subject_id:he,month:n,year:o,date:z[0]},e[5]=xe,e[6]=he,e[7]=n,e[8]=o,e[9]=T):T=e[9];const{data:s,setData:r,get:fe,processing:Fe}=ze(T);let V;e[10]!==fe?(V=l=>{l.preventDefault(),fe("/admin/attendance",{preserveState:!0,preserveScroll:!0})},e[10]=fe,e[11]=V):V=e[11];const ue=V;let q;e[12]!==s.class_room_id||e[13]!==s.date||e[14]!==s.subject_id?(q=()=>{Te.get("/admin/attendance/edit",{class_room_id:s.class_room_id,subject_id:s.subject_id,date:s.date})},e[12]=s.class_room_id,e[13]=s.date,e[14]=s.subject_id,e[15]=q):q=e[15];const be=q;let E;e[16]===Symbol.for("react.memo_cache_sentinel")?(E=[{value:"1",label:"Janeiro"},{value:"2",label:"Fevereiro"},{value:"3",label:"Março"},{value:"4",label:"Abril"},{value:"5",label:"Maio"},{value:"6",label:"Junho"},{value:"7",label:"Julho"},{value:"8",label:"Agosto"},{value:"9",label:"Setembro"},{value:"10",label:"Outubro"},{value:"11",label:"Novembro"},{value:"12",label:"Dezembro"}],e[16]=E):E=e[16];const Ae=E;let L;if(e[17]===Symbol.for("react.memo_cache_sentinel")){const l=new Date().getFullYear();L=Array.from({length:5},(le,I)=>(l-2+I).toString()),e[17]=L}else L=e[17];const ke=L;let R;e[18]===Symbol.for("react.memo_cache_sentinel")?(R=t.jsx(Ve,{title:"Gerenciar Frequência"}),e[18]=R):R=e[18];let B;e[19]===Symbol.for("react.memo_cache_sentinel")?(B=t.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Gerenciar Frequência"}),t.jsx("p",{className:"text-muted-foreground",children:"Consulte o histórico mensal ou lance frequências diárias."})]})}),e[19]=B):B=e[19];let G;e[20]===Symbol.for("react.memo_cache_sentinel")?(G=t.jsxs(Ne,{children:[t.jsx(Se,{className:"text-base",children:"Filtros de Visualização"}),t.jsx(we,{children:"Selecione para ver a grade mensal"})]}),e[20]=G):G=e[20];let H;e[21]===Symbol.for("react.memo_cache_sentinel")?(H=t.jsx(M,{children:"Turma"}),e[21]=H):H=e[21];const Ie=s.class_room_id;let d;e[22]!==r?(d=l=>r("class_room_id",l),e[22]=r,e[23]=d):d=e[23];let O;e[24]===Symbol.for("react.memo_cache_sentinel")?(O=t.jsx(ce,{children:t.jsx(ne,{placeholder:"Selecione a turma"})}),e[24]=O):O=e[24];let m;e[25]!==de?(m=de.map(Ke),e[25]=de,e[26]=m):m=e[26];let x;e[27]!==m?(x=t.jsx(re,{children:m}),e[27]=m,e[28]=x):x=e[28];let h;e[29]!==s.class_room_id||e[30]!==d||e[31]!==x?(h=t.jsxs("div",{className:"space-y-2",children:[H,t.jsxs(ie,{value:Ie,onValueChange:d,children:[O,x]})]}),e[29]=s.class_room_id,e[30]=d,e[31]=x,e[32]=h):h=e[32];let Y;e[33]===Symbol.for("react.memo_cache_sentinel")?(Y=t.jsx(M,{children:"Disciplina"}),e[33]=Y):Y=e[33];const Je=s.subject_id;let f;e[34]!==r?(f=l=>r("subject_id",l),e[34]=r,e[35]=f):f=e[35];let P;e[36]===Symbol.for("react.memo_cache_sentinel")?(P=t.jsx(ce,{children:t.jsx(ne,{placeholder:"Selecione a disciplina"})}),e[36]=P):P=e[36];let u;e[37]!==me?(u=me.map($e),e[37]=me,e[38]=u):u=e[38];let b;e[39]!==u?(b=t.jsx(re,{children:u}),e[39]=u,e[40]=b):b=e[40];let p;e[41]!==s.subject_id||e[42]!==f||e[43]!==b?(p=t.jsxs("div",{className:"space-y-2",children:[Y,t.jsxs(ie,{value:Je,onValueChange:f,children:[P,b]})]}),e[41]=s.subject_id,e[42]=f,e[43]=b,e[44]=p):p=e[44];let $;e[45]===Symbol.for("react.memo_cache_sentinel")?($=t.jsx(M,{children:"Mês"}),e[45]=$):$=e[45];let j;e[46]!==r?(j=l=>r("month",l),e[46]=r,e[47]=j):j=e[47];let K;e[48]===Symbol.for("react.memo_cache_sentinel")?(K=t.jsx(ce,{children:t.jsx(ne,{})}),e[48]=K):K=e[48];let Q;e[49]===Symbol.for("react.memo_cache_sentinel")?(Q=t.jsx(re,{children:Ae.map(Pe)}),e[49]=Q):Q=e[49];let _;e[50]!==s.month||e[51]!==j?(_=t.jsxs("div",{className:"space-y-2",children:[$,t.jsxs(ie,{value:s.month,onValueChange:j,children:[K,Q]})]}),e[50]=s.month,e[51]=j,e[52]=_):_=e[52];let U;e[53]===Symbol.for("react.memo_cache_sentinel")?(U=t.jsx(M,{children:"Ano"}),e[53]=U):U=e[53];let g;e[54]!==r?(g=l=>r("year",l),e[54]=r,e[55]=g):g=e[55];let W;e[56]===Symbol.for("react.memo_cache_sentinel")?(W=t.jsx(ce,{children:t.jsx(ne,{})}),e[56]=W):W=e[56];let X;e[57]===Symbol.for("react.memo_cache_sentinel")?(X=t.jsx(re,{children:ke.map(Ye)}),e[57]=X):X=e[57];let y;e[58]!==s.year||e[59]!==g?(y=t.jsxs("div",{className:"space-y-2",children:[U,t.jsxs(ie,{value:s.year,onValueChange:g,children:[W,X]})]}),e[58]=s.year,e[59]=g,e[60]=y):y=e[60];let v;e[61]!==_||e[62]!==y?(v=t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[_,y]}),e[61]=_,e[62]=y,e[63]=v):v=e[63];const pe=!s.class_room_id||!s.subject_id||Fe;let Z;e[64]===Symbol.for("react.memo_cache_sentinel")?(Z=t.jsx(Re,{className:"mr-2 h-4 w-4"}),e[64]=Z):Z=e[64];let N;e[65]!==ue||e[66]!==pe?(N=t.jsxs(De,{onClick:ue,className:"w-full",disabled:pe,children:[Z,"Buscar Grade Mensal"]}),e[65]=ue,e[66]=pe,e[67]=N):N=e[67];let S;e[68]!==h||e[69]!==p||e[70]!==v||e[71]!==N?(S=t.jsxs(ge,{children:[G,t.jsxs(Ce,{className:"space-y-4",children:[h,p,v,N]})]}),e[68]=h,e[69]=p,e[70]=v,e[71]=N,e[72]=S):S=e[72];let ee;e[73]===Symbol.for("react.memo_cache_sentinel")?(ee=t.jsxs(Ne,{children:[t.jsx(Se,{className:"text-base",children:"Lançamento Rápido"}),t.jsx(we,{children:"Ir para edição de um dia específico"})]}),e[73]=ee):ee=e[73];let te;e[74]===Symbol.for("react.memo_cache_sentinel")?(te=t.jsx(M,{children:"Data Específica"}),e[74]=te):te=e[74];let w;e[75]!==r?(w=l=>r("date",l.target.value),e[75]=r,e[76]=w):w=e[76];let C;e[77]!==s.date||e[78]!==w?(C=t.jsxs("div",{className:"space-y-2",children:[te,t.jsx(Le,{type:"date",value:s.date,onChange:w})]}),e[77]=s.date,e[78]=w,e[79]=C):C=e[79];const je=!s.class_room_id||!s.subject_id;let D;e[80]!==be||e[81]!==je?(D=t.jsx(De,{onClick:be,className:"w-full",disabled:je,children:"Ir para Lançamento"}),e[80]=be,e[81]=je,e[82]=D):D=e[82];let F;e[83]!==C||e[84]!==D?(F=t.jsxs(ge,{className:"bg-muted/30",children:[ee,t.jsxs(Ce,{className:"space-y-4",children:[C,D]})]}),e[83]=C,e[84]=D,e[85]=F):F=e[85];let A;e[86]!==S||e[87]!==F?(A=t.jsxs("div",{className:"space-y-6",children:[S,F]}),e[86]=S,e[87]=F,e[88]=A):A=e[88];let k;e[89]!==i?(k=t.jsx("div",{className:"space-y-6",children:i?t.jsxs(ge,{className:"overflow-hidden border-2 shadow-sm",children:[t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm text-left border-collapse",children:[t.jsx("thead",{className:"bg-gray-100 text-gray-700 font-semibold sticky top-0 z-10",children:t.jsxs("tr",{children:[t.jsx("th",{className:"p-2 border-b border-r w-12 text-center bg-gray-100 sticky left-0 z-20",children:"Nº"}),t.jsx("th",{className:"p-2 border-b border-r min-w-[200px] bg-gray-100 sticky left-12 z-20",children:"Aluno"}),Array.from({length:i.daysInMonth},Oe).map(l=>{const le=i.diaries?.[l];return t.jsx("th",{className:ye("p-1 border-b border-r text-center w-8 min-w-[32px] font-mono text-xs",le?"bg-white text-black":"text-gray-400 bg-gray-50/50"),children:l},l)}),t.jsx("th",{className:"p-2 border-b border-r w-16 text-center bg-gray-50 font-bold text-red-600",children:"F"}),t.jsx("th",{className:"p-2 border-b w-16 text-center bg-gray-50 font-bold text-blue-600",children:"%"})]})}),t.jsx("tbody",{className:"divide-y",children:i.students.map((l,le)=>{const I=i.metrics[l.id];return t.jsxs("tr",{className:"hover:bg-gray-50/80 transition-colors",children:[t.jsx("td",{className:"p-2 border-r text-center text-gray-500 sticky left-0 bg-white",children:le+1}),t.jsx("td",{className:"p-2 border-r font-medium sticky left-12 bg-white",children:l.name}),Array.from({length:i.daysInMonth},He).map(ve=>{const ae=i.matrix[l.id]?.[ve];let J=null,_e="";return ae==="present"?J=t.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500 mx-auto"}):ae==="absent"?(J=t.jsx("span",{className:"text-red-600 font-bold",children:"F"}),_e="bg-red-50"):ae==="justified"?(J=t.jsx("span",{className:"text-amber-600 font-bold text-xs",title:"Justificado",children:"J"}),_e="bg-amber-50"):ae==="late"&&(J=t.jsx("span",{className:"text-orange-500 font-bold text-xs",children:"A"})),t.jsx("td",{className:ye("p-0 border-r text-center h-8",_e),children:J},ve)}),t.jsx("td",{className:"p-2 border-r text-center font-bold text-red-600 bg-gray-50/30",children:I?.total_absences||0}),t.jsxs("td",{className:ye("p-2 text-center font-bold bg-gray-50/30",(I?.percentage||100)<75?"text-red-600":"text-blue-600"),children:[I?.percentage||100,"%"]})]},l.id)})})]})}),t.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-t text-xs text-muted-foreground flex justify-between",children:[t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"})," Presente"]}),t.jsx("span",{className:"flex items-center gap-1 font-bold text-red-600",children:"F"})," Falta",t.jsx("span",{className:"flex items-center gap-1 font-bold text-amber-600",children:"J"})," Justificado"]}),t.jsxs("div",{children:["Total de aulas no período: ",Object.values(i.diaries||{}).reduce(Ge,0)]})]})]}):t.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center border-2 border-dashed rounded-lg bg-gray-50 h-full min-h-[400px]",children:[t.jsx(qe,{className:"w-12 h-12 text-gray-300 mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Selecione os filtros"}),t.jsx("p",{className:"text-muted-foreground max-w-sm",children:"Escolha a turma, disciplina, mês e ano para visualizar a grade de frequência."})]})}),e[89]=i,e[90]=k):k=e[90];let se;return e[91]!==A||e[92]!==k?(se=t.jsxs(Ee,{breadcrumbs:Be,children:[R,t.jsxs("div",{className:"flex flex-col gap-6 p-4 max-w-[1400px] mx-auto w-full pb-20",children:[B,t.jsxs("div",{className:"grid gap-6 md:grid-cols-[350px_1fr]",children:[A,k]})]})]}),e[91]=A,e[92]=k,e[93]=se):se=e[93],se}function Ge(a,e){return a+e.classes_count}function He(a,e){return e+1}function Oe(a,e){return e+1}function Ye(a){return t.jsx(oe,{value:a,children:a},a)}function Pe(a){return t.jsx(oe,{value:a.value,children:a.label},a.value)}function $e(a){return t.jsx(oe,{value:String(a.id),children:a.name},a.id)}function Ke(a){return t.jsx(oe,{value:String(a.id),children:a.name},a.id)}export{Nt as default};
