import{r as y,j as e,H as C,L as S,a as _}from"./app-BlZNpJaz.js";import{A,G as L}from"./app-layout-vfDevXcM.js";import{C as h,a as B,b as D,c as F}from"./card-DE5xUgg4.js";import{B as E}from"./button-BFaAQ1F0.js";import{T as P,a as $,b as u,c as j}from"./tabs-3iks6wee.js";import{B as o}from"./badge-hQq2_SSh.js";import{T as g,a as f,b as n,c as l,d as N,e as t}from"./table-DRoYhqJ6.js";import{I as q}from"./input-ClKI_C3W.js";import{t as b}from"./index-Dzrob8QY.js";import{A as z}from"./arrow-left-C_Tsc45O.js";import{U as G}from"./user-Bs0CfZmM.js";/* empty css            */import"./index-BSNktiLJ.js";import"./utils-CTsRgsKi.js";import"./index-DWBLVih3.js";import"./createLucideIcon-G_Aima0p.js";import"./index-II6TlMg7.js";import"./Combination-CQbiwxas.js";import"./index-ePvy9ijt.js";import"./index-CClcdcON.js";import"./index-DSX7JKB1.js";import"./index-20W_Bwtk.js";import"./index-kh-3lYpY.js";import"./index-jOkOEACf.js";import"./settings-DDioBNBR.js";import"./users-CYmdu12r.js";import"./file-text-BPl73Zr-.js";import"./chevron-right-BaSAJNUd.js";function ue({classRoom:i,student:d,subject:m,attendanceHistory:r,periods:p}){const v=[{title:"Painel",href:"/professor/dashboard"},{title:i.name,href:`/professor/classes/${i.id}`},{title:d.name,href:""}],[V,M]=y.useState(!1),w=async(s,a)=>{const x=a===""?null:parseFloat(a);try{await _.post(`/professor/classes/${i.id}/grades/batch`,{grading_period_id:p.find(c=>c.assessments.some(T=>T.id===s))?.id,subject_id:m.id,grades:[{student_id:d.id,assessment_id:s,score:x}]}),b.success("Nota atualizada.")}catch(c){console.error(c),b.error("Erro ao atualizar nota.")}};return e.jsxs(A,{breadcrumbs:v,children:[e.jsx(C,{title:`Aluno: ${d.name}`}),e.jsxs("div",{className:"p-4 md:p-8 max-w-5xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx(E,{variant:"outline",size:"icon",asChild:!0,children:e.jsx(S,{href:`/professor/classes/${i.id}`,children:e.jsx(z,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:d.name}),e.jsxs("p",{className:"text-muted-foreground",children:[i.name," • ",m.name]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs(h,{className:"md:col-span-1 h-fit",children:[e.jsx(B,{children:e.jsx(D,{children:"Resumo"})}),e.jsxs(F,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg",children:[e.jsx(G,{className:"h-8 w-8 text-slate-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-500",children:"Matrícula"}),e.jsxs("p",{className:"font-bold flex items-center gap-2",children:["#",d.id.toString().padStart(6,"0")]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg text-center",children:[e.jsx("p",{className:"text-xs font-bold text-blue-600 uppercase",children:"Aulas"}),e.jsx("p",{className:"text-xl font-bold text-blue-900",children:r.length})]}),e.jsxs("div",{className:"p-3 bg-green-50 rounded-lg text-center",children:[e.jsx("p",{className:"text-xs font-bold text-green-600 uppercase",children:"Presenças"}),e.jsx("p",{className:"text-xl font-bold text-green-900",children:r.filter(s=>s.status==="present").length})]})]}),e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg text-center",children:[e.jsx("p",{className:"text-xs font-bold text-slate-600 uppercase",children:"Taxa de Frequência"}),e.jsxs("p",{className:"text-2xl font-bold text-slate-900",children:[r.length>0?Math.round(r.filter(s=>s.status==="present").length/r.length*100):100,"%"]})]})]})]}),e.jsx(h,{className:"md:col-span-2",children:e.jsxs(P,{defaultValue:"grades",className:"w-full",children:[e.jsx("div",{className:"px-6 pt-6",children:e.jsxs($,{className:"w-full justify-start border-b rounded-none p-0 h-auto bg-transparent gap-6",children:[e.jsx(u,{value:"grades",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-primary py-2 px-1",children:"Notas & Avaliações"}),e.jsx(u,{value:"attendance",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-primary py-2 px-1",children:"Histórico de Frequência"})]})}),e.jsx(j,{value:"grades",className:"p-6",children:e.jsx("div",{className:"space-y-6",children:p.map(s=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5 text-indigo-600"}),s.name,s.status==="closed"&&e.jsx(o,{variant:"secondary",children:"Fechado"})]}),e.jsxs(g,{children:[e.jsx(f,{children:e.jsxs(n,{children:[e.jsx(l,{children:"Avaliação"}),e.jsx(l,{className:"w-[100px] text-center",children:"Data"}),e.jsx(l,{className:"w-[80px] text-center",children:"Peso"}),e.jsx(l,{className:"w-[100px] text-center",children:"Nota"})]})}),e.jsx(N,{children:s.assessments&&s.assessments.length>0?s.assessments.map(a=>{const x=a.grades&&a.grades.length>0?a.grades[0]:null;return e.jsxs(n,{children:[e.jsxs(t,{children:[e.jsx("div",{className:"font-medium",children:a.title}),a.is_recovery&&e.jsx(o,{variant:"destructive",className:"text-[10px] h-4",children:"REC"})]}),e.jsx(t,{className:"text-center text-muted-foreground text-xs",children:new Date(a.date).toLocaleDateString()}),e.jsx(t,{className:"text-center text-xs",children:a.weight}),e.jsx(t,{children:e.jsx(q,{type:"number",step:"0.1",min:"0",max:a.max_points,defaultValue:x?x.score:"",disabled:s.status==="closed",onBlur:c=>w(a.id,c.target.value),className:"h-8 text-center"})})]},a.id)}):e.jsx(n,{children:e.jsx(t,{colSpan:4,className:"text-muted-foreground text-center text-sm",children:"Nenhuma avaliação neste período."})})})]})]},s.id))})}),e.jsx(j,{value:"attendance",className:"p-6",children:e.jsxs(g,{children:[e.jsx(f,{children:e.jsxs(n,{children:[e.jsx(l,{className:"w-[120px]",children:"Data"}),e.jsx(l,{children:"Conteúdo"}),e.jsx(l,{className:"text-right w-[100px]",children:"Status"})]})}),e.jsxs(N,{children:[r.map(s=>e.jsxs(n,{children:[e.jsx(t,{className:"font-medium",children:new Date(s.class_diary.date).toLocaleDateString()}),e.jsx(t,{className:"text-muted-foreground text-sm truncate max-w-[200px]",children:s.class_diary.content||"-"}),e.jsx(t,{className:"text-right",children:e.jsx(o,{variant:s.status==="present"?"default":s.status==="justified"?"secondary":"destructive",children:s.status==="present"?"Presente":s.status==="justified"?"Justificada":"Falta"})})]},s.id)),r.length===0&&e.jsx(n,{children:e.jsx(t,{colSpan:3,className:"text-center py-6 text-muted-foreground",children:"Nenhum registro de frequência."})})]})]})})]})})]})]})]})}export{ue as default};
